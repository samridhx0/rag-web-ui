<!DOCTYPE html>
<html lang="en" class="h-full bg-zinc-950 text-zinc-100 antialiased selection:bg-indigo-600/80">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RAG Document Q&A Demo</title>
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              primary: {
                50: '#eef2ff', 100: '#e0e7ff', 200: '#c7d2fe', 300: '#a5b4fc',
                400: '#818cf8', 500: '#6366f1', 600: '#4f46e5', 700: '#4338ca',
                800: '#3730a3', 900: '#312e81'
              }
            },
            fontFamily: {
              sans: ['Inter','ui-sans-serif','system-ui']
            }
          }
        }
      }
    </script>
    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  </head>
  <body class="h-full flex flex-col">
    <!-- Hero Section -->
    <section class="relative bg-zinc-900 text-center py-20 px-4 sm:px-8 overflow-hidden">
      <!-- Background Blobs -->
      <svg class="absolute -top-10 -left-10 opacity-20 w-64 h-64 text-primary-600" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 200 200">
        <path d="M43.2,-68.5C56.3,-60.8,67.9,-50.3,74.2,-37.2C80.5,-24.1,81.5,-8.4,78.4,7.8C75.3,24,68.1,40.7,56.4,53.2C44.7,65.7,28.4,74.1,11,79.8C-6.4,85.5,-23.7,88.4,-38.8,83.8C-53.9,79.3,-66.6,67.4,-72.9,52.3C-79.1,37.2,-79,19.6,-78.2,2.1C-77.4,-15.4,-75.8,-30.8,-67.3,-42.8C-58.8,-54.9,-43.4,-63.6,-27.2,-70C-11,-76.3,6.2,-80.2,21.8,-75.3C37.4,-70.4,51.1,-56.2,43.2,-68.5Z" transform="translate(100 100)" />
      </svg>
      <h1 class="text-5xl sm:text-6xl font-bold bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent">
        RAG Document Q&A
      </h1>
      <p class="mt-4 max-w-xl mx-auto text-lg text-zinc-300">
        Instantly upload any text document and get concise, AI-powered answers. Built with GPT-4, LangChain, and Chroma.
      </p>
      <div class="mt-8 flex justify-center gap-4">
        <a href="#upload" class="px-6 py-3 bg-primary-600 hover:bg-primary-500 text-white rounded-lg font-medium transition">
          Get Started
        </a>
        <a href="#features" class="px-6 py-3 border border-primary-500 hover:bg-zinc-800 text-primary-400 rounded-lg font-medium transition">
          Features
        </a>
      </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="bg-zinc-800 py-16 px-4 sm:px-8">
      <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="p-6 bg-zinc-900 rounded-2xl text-center">
          <div class="mb-4 inline-block p-3 bg-primary-600/20 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v4a1 1 0 001 1h3m10-5v4a1 1 0 01-1 1h-3M4 17v-2a1 1 0 011-1h3m10 3v-2a1 1 0 00-1-1h-3" />
            </svg>
          </div>
          <h3 class="font-semibold text-xl mb-2">Seamless Upload</h3>
          <p class="text-zinc-400">Drag & drop or browse to import your .txt files in seconds.</p>
        </div>
        <div class="p-6 bg-zinc-900 rounded-2xl text-center">
          <div class="mb-4 inline-block p-3 bg-primary-600/20 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M21 12a9 9 0 11-6.219-8.56" />
            </svg>
          </div>
          <h3 class="font-semibold text-xl mb-2">Instant Q&A</h3>
          <p class="text-zinc-400">Ask any question and get concise, three-sentence answers powered by GPT-4.</p>
        </div>
        <div class="p-6 bg-zinc-900 rounded-2xl text-center">
          <div class="mb-4 inline-block p-3 bg-primary-600/20 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-6a2 2 0 012-2h2a2 2 0 012 2v6m-6 0h6" />
            </svg>
          </div>
          <h3 class="font-semibold text-xl mb-2">Smart Retrieval</h3>
          <p class="text-zinc-400">Automatically chunks and retrieves relevant context using vector similarity.</p>
        </div>
      </div>
    </section>

    <!-- Upload Section -->
    <section id="upload" class="py-16 px-4 sm:px-8">
      <div class="max-w-4xl mx-auto">
        <div class="border border-zinc-800 rounded-2xl p-6 bg-zinc-900/80 backdrop-blur-lg">
          <h2 class="text-2xl font-medium mb-4">Upload Your Document</h2>
          <div id="dropZone" class="relative flex flex-col items-center justify-center border-2 border-dashed border-zinc-700 rounded-xl p-8 text-center cursor-pointer hover:border-primary-500 transition-colors">
            <input id="fileInput" type="file" accept=".txt" class="absolute inset-0 opacity-0 cursor-pointer" />
            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-zinc-500 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1M12 12v9m0-9l3 3m-3-3l-3 3" />
            </svg>
            <p class="text-sm text-zinc-400">Drag & drop a <span class="font-medium text-zinc-100">.txt</span> file here, or <span class="underline">click to browse</span>.</p>
          </div>
          <p id="uploadStatus" class="mt-4 text-sm text-zinc-400 hidden"></p>
        </div>
      </div>
    </section>

    <!-- Q&A Section -->
    <section class="py-16 px-4 sm:px-8 flex-1">
      <div class="max-w-4xl mx-auto">
        <div class="border border-zinc-800 rounded-2xl p-6 bg-zinc-900/80 backdrop-blur-lg">
          <h2 class="text-2xl font-medium mb-4">Ask a Question</h2>
          <div class="flex gap-3">
            <input id="questionInput" type="text" placeholder="Type your question here…" class="flex-1 bg-zinc-900/70 border border-zinc-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" />
            <button id="askBtn" class="px-5 py-2 rounded-lg font-medium bg-primary-600 hover:bg-primary-500 transition disabled:opacity-50 disabled:cursor-not-allowed">Ask</button>
          </div>
          <div id="answerBox" class="prose prose-invert max-w-none mt-4 hidden"></div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="py-8 text-center text-sm text-zinc-500">© 2025 Samridh X0 — RAG Q&A Demo</footer>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-6 left-1/2 -translate-x-1/2 bg-zinc-800 text-zinc-100 px-5 py-3 rounded-lg shadow-lg opacity-0 transition-opacity"></div>

    <!-- Scripts -->
    <script>
      const backendURL = "https://<your-app>.onrender.com";
      const dropZone = document.getElementById('dropZone');
      const fileInput = document.getElementById('fileInput');
      const uploadStatus = document.getElementById('uploadStatus');
      const questionInput = document.getElementById('questionInput');
      const askBtn = document.getElementById('askBtn');
      const answerBox = document.getElementById('answerBox');
      const toast = document.getElementById('toast');
      let documentId = null;

      function showToast(msg) {
        toast.textContent = msg;
        toast.classList.remove('opacity-0');
        clearTimeout(toast._timeout);
        toast._timeout = setTimeout(() => toast.classList.add('opacity-0'), 3000);
      }

      dropZone.addEventListener('click', () => fileInput.click());
      dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.classList.add('border-primary-500'); });
      dropZone.addEventListener('dragleave', () => dropZone.classList.remove('border-primary-500'));  
      dropZone.addEventListener('drop', e => {
        e.preventDefault(); dropZone.classList.remove('border-primary-500');
        const file = e.dataTransfer.files[0]; if (file) handleUpload(file);
      });
      fileInput.addEventListener('change', e => { const file = e.target.files[0]; if (file) handleUpload(file); });

      async function handleUpload(file) {
        if (file.type !== 'text/plain') return showToast('Only .txt files allowed');
        uploadStatus.classList.remove('hidden'); uploadStatus.textContent = `Uploading: ${file.name}`;
        const formData = new FormData(); formData.append('file', file);
        try {
          const res = await fetch(`${backendURL}/upload`, { method: 'POST', body: formData });
          const json = await res.json(); if (!res.ok) throw new Error(json.error || 'Upload failed');
          documentId = json.document_id;
          uploadStatus.textContent = `✅ Uploaded (${json.chunks_created} chunks)`;
          showToast('File processed successfully'); askBtn.disabled = false;
        } catch (err) {
          console.error(err);
          uploadStatus.textContent = '❌ Upload failed'; showToast(err.message);
        }
      }

      askBtn.addEventListener('click', askQuestion);
      questionInput.addEventListener('keydown', e => { if (e.key === 'Enter') askQuestion(); });

      async function askQuestion() {
        const question = questionInput.value.trim();
        if (!question) return showToast('Type a question first');
        if (!documentId) return showToast('Upload a document first');
        askBtn.disabled = true; uploadStatus.textContent = 'Thinking…'; answerBox.classList.add('hidden');
        try {
          const res = await fetch(`${backendURL}/query`, {
            method: 'POST', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ question })
          });
          const json = await res.json(); if (!res.ok) throw new Error(json.error || 'Query failed');
          answerBox.innerHTML = `<p>${json.answer}</p>`; answerBox.classList.remove('hidden'); uploadStatus.textContent = '';
        } catch (err) {
          console.error(err); showToast(err.message);
        } finally {
          askBtn.disabled = false;
        }
      }
    </script>
  </body>
</html>
